#!/bin/bash
#------------------------------------------------------------==ADM==
# Custom Software, Developed for CUHEP by staff.
# This software is in the public domain, furnished "as is", without
# technical support, and with no warranty, express or implied, as
# to its usefulness for any purpose.
#
# CreateSL7KickStart      
#
# REVISION HISTORY
# Created.                                  06/19/2017  doug johnson
#-------------------------------------------------------------------

template='centos7-template.cfg'
template='templates/centos7-minimal-template.cfg'
hostname=$1
ipaddr=$2
netmask=$3
gateway=$4
rootdisk=$5

ipaddr=`/usr/local/adm/puppet/kickstarts/GetHostInfo $hostname | awk '{print $2}'`
netmask=`/usr/local/adm/puppet/kickstarts/GetHostInfo $hostname | awk '{print $3}'`
gateway=`/usr/local/adm/puppet/kickstarts/GetHostInfo $hostname | awk '{print $4}'`
rootdisk=`/usr/local/adm/puppet/kickstarts/GetHostInfo $hostname | awk '{print $5}'`

date=`date`
output="/nfs/admin01/adm/puppet/kickstarts/config/$hostname.ks"
echo `date`" Creating kickstart file: $output"
sed s%ROOTDISK%${rootdisk}%g $template | sed s/%IPADDR%/$ipaddr/g | sed s/%HOSTNAME%/$hostname/g | sed s/%NETMASK%/$netmask/g | sed s/%GATEWAY%/$gateway/g | sed s/%DATE%/"$date"/g > $output

exit



